# GC
1. 悬挂指针
答：指针指向的内存被回收，导致指向失效，即“悬空”。
2. 标记——清扫算法
- 将栈、数据段上的数据对象认为是root，基于root开始追踪，追踪到的数据进行标记。追踪不到的就是垃圾。
- 缺点：内存碎片化
  - 解决方案：BiBOP（Big Bag Of Pages）内存块划分为多种大小规格，相同规格内存统一管理，可以更快匹配到大小合适的空闲内存。
  - 标记整理算法，移动数据是内存使用紧凑化。
  - 复制式回收（堆内存分为from和to两个空间，from用于执行时分配，to用于将from中可追踪到的数据复制紧凑到to中，然后交换角色。
  - 分代回收：将数据分新生代（少数量GC就被回收）和老年代（经历了多次GC仍未被回收），可以降低老年代GC频率。可采用不同的回收策略。
3. 引用技术
- 一个数据对象被引用的次数

**2，3都是暂停用户程序，专注于垃圾回收前提下展开。STW（Stop the World）**
## 三色标记法
### 三色标记法核心过程
- 遍历灰色集合，将灰色对象标记为黑色，放到黑色集合中
- 将黑色对象引用的白色对象标记为灰色，放到灰色集合中
- 重复上面两个步骤，直到不存在灰色对象，并清除所有的白色对象

### 没有STW的三色标记法
不执行STW时，满足下面两个条件会破坏垃圾收集器的正确性：
- 条件1：某个黑色对象引用白色对象
- 条件2：从灰色对象出发，到达白色对象的，未经访问过的路径遭到破坏

## 屏障技术
### 强三色不变性和弱三色不变性
只要破坏“误杀”的两个必要条件，即可保证对象不丢失。
- 强三色不变性：黑色对象不会指向白色对象，只会指向灰色对象或黑色对象
- 弱三色不变性：黑色对象指向的白色对象，必须包含一条从灰色对象经由多个白色对象的可达路径

### 屏障技术
#### 插入写屏障
**在黑色对象引用一个白色对象时，将白色对象改为灰色**
在对象A引用对象B时，对象B被标记为灰色，满足强三色不变性。
（Go语言没有选择启用栈上的写屏障机制）
- 根集合：垃圾收集器在标记过程中最先检查的对象
  - 全局变量：程序在编译期
